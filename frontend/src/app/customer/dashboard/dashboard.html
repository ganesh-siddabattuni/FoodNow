<div class="hero-banner">
  <div class="hero-bg-image"></div>
  <div class="hero-overlay"></div>
  <div class="hero-content">
    <h2 class="text-4xl md:text-5xl font-extrabold text-white">
      Taste the Convenience
    </h2>
    <p class="mt-4 text-lg text-text-light max-w-xl">
      Get your favorite meals delivered fast, right to your door.
    </p>
  </div>
</div>

<div class="filters-container">
  <h3 class="text-2xl font-bold mb-4">Find Your Craving</h3>
  <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
    <div class="search-wrapper md:col-span-2">
      <svg
        class="search-icon"
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 24 24"
        fill="currentColor"
      >
        <path
          d="M21.53 20.47l-4.81-4.81A7.94 7.94 0 1016 16.53l4.81 4.81a.75.75 0 001.06 0 .75.75 0 000-1.06zM10 16a6 6 0 110-12 6 6 0 010 12z"
        />
      </svg>
      <input
        type="text"
        [ngModel]="searchTerm()"
        (ngModelChange)="searchTerm.set($event)"
        class="form-input search-input"
        placeholder="Search for restaurants or dishes..."
      />
    </div>

    <select
      [ngModel]="dietaryFilter()"
      (ngModelChange)="dietaryFilter.set($event)"
      class="form-input"
    >
      <option value="ALL">All Dietary Types</option>
      <option value="VEG">Veg</option>
      <option value="NON_VEG">Non-Veg</option>
      <option value="VEGAN">Vegan</option>
    </select>

    <select
      [ngModel]="categoryFilter()"
      (ngModelChange)="categoryFilter.set($event)"
      class="form-input"
    >
      <option value="ALL">All Categories</option>
      <option value="STARTER">Starters</option>
      <option value="MAIN_COURSE">Main Course</option>
      <option value="DESSERT">Desserts</option>
      <option value="DRINK">Drinks</option>
    </select>
  </div>
</div>

<div class="restaurants-container">
  @for (restaurant of filteredRestaurants(); track restaurant.id) {
  <div class="restaurant-card">
    <a [routerLink]="['/customer/restaurant', restaurant.id]" class="card-link">
      <div class="card-image-wrapper">
        <img
          [src]="
            (restaurant.imageUrl | fullUrl) ||
            'https://placehold.co/600x400/1f2937/9ca3af?text=FoodNow'
          "
          [alt]="restaurant.name"
          class="card-image"
        />
      </div>
      <div class="p-4">
        <h3 class="text-xl font-bold text-primary truncate">
          {{ restaurant.name }}
        </h3>
        <p class="text-text-dark mt-1 text-sm truncate">
          {{ restaurant.address }}
        </p>

        @if(restaurant.averageRating && restaurant.averageRating > 0) {
        <div
          class="card-rating flex items-center space-x-1 text-yellow-500 font-semibold mt-1"
        >
          <span class="star">&#9733;</span>
          <span>{{ restaurant.averageRating | number : "1.1-1" }}</span>
        </div>
        }

        <div class="dietary-tags mt-2 space-x-2">
          @if(restaurant.dietaryCounts?.VEG ?? 0 > 0) {
          <span class="tag veg-tag">Veg</span> }
          @if(restaurant.dietaryCounts?.NON_VEG ?? 0 > 0) {
          <span class="tag non-veg-tag">Non-Veg</span> }
          @if(restaurant.dietaryCounts?.VEGAN ?? 0 > 0) {
          <span class="tag vegan-tag">Vegan</span> }
        </div>
      </div>
    </a>

    @if (restaurant.matchingItems && restaurant.matchingItems.length > 0) {
    <div class="matching-items-section p-4 border-t">
      <h4 class="font-semibold text-sm mb-2 text-primary">Matching Items:</h4>
      <ul class="text-sm space-y-1">
        @for(item of restaurant.matchingItems; track item.id) {
        <li class="text-text-muted">
          {{ item.name }} - â‚¹{{ item.price.toFixed(2) }}
        </li>
        }
      </ul>
    </div>
    }
  </div>
  } @empty {
  <div class="empty-state">
    <svg
      xmlns="http://www.w3.org/2000/svg"
      class="w-16 h-16 text-border"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="1.5"
      stroke-linecap="round"
      stroke-linejoin="round"
    >
      <circle cx="11" cy="11" r="8"></circle>
      <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
      <line x1="11" y1="8" x2="11" y2="14"></line>
      <line x1="8" y1="11" x2="14" y2="11"></line>
    </svg>
    <p class="mt-4 text-lg text-text-dark">No Restaurants Found</p>
    <p class="text-text-dark">Try adjusting your search or filters.</p>
  </div>
  }
</div>
